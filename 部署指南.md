# 本地部署指南

## 🚀 快速启动

### 第一步：检查环境
确保你已安装：
- Node.js (版本 16+)
- Python (版本 3.8+)
- npm 或 yarn

### 第二步：启动后端服务

```bash
# 进入后端目录
cd F:\360MoveData\Users\administered\Desktop\588\backend

# 安装Python依赖
pip install -r requirements.txt

# 初始化数据库
python init_database.py

# 启动后端服务
python run.py
```

后端将在 `http://localhost:5000` 启动

### 第三步：启动前端服务

```bash
# 打开新的命令行窗口，进入项目根目录
cd F:\360MoveData\Users\administered\Desktop\588

# 安装前端依赖
npm install

# 启动前端开发服务器
npm run dev
```

前端将在 `http://localhost:5173` 启动

## 🌟 功能演示路径

### 完整的用户体验流程：

1. **访问首页**: `http://localhost:5173/`
2. **开始诊断**: 点击"开始健康评估"
3. **完成19题问卷**: 体验新的评分系统
4. **查看诊断结果**: 
   - 睡眠质量评分（96分制）
   - 证型分析（6种类型）
   - 二元诊断矩阵
5. **产品推荐**: 
   - 查看个性化产品推荐
   - 组合优惠信息
6. **购买流程**:
   - 加入购物车
   - 查看购物车 (`/cart`)
   - 结算订单 (`/checkout`)
   - 完成支付 (`/order-success`)

## 🔧 特殊功能测试

### 测试第1题特殊逻辑
- 第1题选择"好" → 直接跳转恭喜页面，显示96/96分

### 测试第9题特殊逻辑  
- 第9题选择"半年以上" → 强制判定为"差"，建议就医

### 测试数据保存功能
- 完成诊断后，数据会自动保存到后端数据库
- 检查后端日志确认保存成功

## 📊 后端API测试

可以直接访问API端点：

- 健康检查: `http://localhost:5000/api/health`
- 问卷信息: `http://localhost:5000/api/diagnosis/info`
- 分级标准: `http://localhost:5000/api/diagnosis/grades`

## 🛠️ 故障排除

### 常见问题：

1. **端口被占用**
   ```bash
   # Windows查看端口占用
   netstat -ano | findstr :5000
   netstat -ano | findstr :5173
   ```

2. **Python依赖安装失败**
   ```bash
   # 使用国内镜像
   pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
   ```

3. **前端依赖安装慢**
   ```bash
   # 使用cnpm或yarn
   npm install --registry=https://registry.npm.taobao.org
   ```

4. **数据库初始化失败**
   ```bash
   # 删除旧数据库文件重新初始化
   rm insomnia_diagnosis.db
   python init_database.py
   ```

## 📱 移动端访问

项目支持响应式设计，可以：
- 手机浏览器访问 `http://你的电脑IP:5173`
- 同一局域网下其他设备访问

## 🎯 核心功能验证清单

- [ ] 19题问卷正常工作
- [ ] 评分系统准确计算（96分制）  
- [ ] 证型诊断正确显示
- [ ] 产品推荐基于证型
- [ ] 购物车添加/删除功能
- [ ] 组合优惠正确计算
- [ ] 订单结算流程完整
- [ ] 数据保存到数据库
- [ ] API接口正常响应

## 🚀 部署成功后你将看到：

1. **现代化的UI界面** - 基于Element Plus的专业设计
2. **智能诊断系统** - 19题评估+二元诊断矩阵  
3. **个性化推荐** - 根据证型推荐产品组合
4. **完整购物流程** - 从诊断到购买的商业闭环
5. **响应式设计** - 适配PC和移动端

开始部署吧！🎉